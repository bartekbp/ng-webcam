!function(){"use strict";function n(){function n(){return['<div class="ng-webcam" ng-show="vm.webcamLive">','<div id="ng-webcam-container"></div>'].join("")}function i(n,i,e,o){o.init(),n.$on("$destroy",function(){o.destroy()})}function e(n,i){function e(){d.config=d.config||{},angular.isUndefined(d.config.viewerWidth)&&(d.config.viewerWidth="auto"),angular.isUndefined(d.config.viewerHeight)&&(d.config.viewerHeight="auto"),angular.isUndefined(d.config.outputWidth)&&(d.config.outputWidth=320),angular.isUndefined(d.config.outputHeight)&&(d.config.outputHeight=240),angular.isUndefined(d.config.delay)&&(d.config.delay=0),angular.isUndefined(d.config.shots)&&(d.config.shots=1),t(),c()}function o(){Webcam.reset(),d.webcamLive=!1,d.webcamLoaded=!1}function t(){angular.isDefined(d.config.shutterUrl)&&(u=new Audio,u.autoplay=!1,navigator.userAgent.match(/Firefox/)?u.src=d.config.shutterUrl.split(".")[0]+".ogg":u.src=d.config.shutterUrl),Webcam.set({width:d.config.viewerWidth,height:d.config.viewerHeight,dest_width:d.config.outputWidth,dest_height:d.config.outputHeight}),angular.isDefined(d.config.flashFallbackUrl)&&Webcam.setSWFLocation(d.config.flashFallbackUrl),Webcam.attach("#ng-webcam-container")}function c(){Webcam.on("load",function(){n.$apply(function(){d.webcamLoaded=!0,angular.isDefined(d.onLoad)&&d.onLoad()})}),Webcam.on("live",function(){n.$apply(function(){d.webcamLive=!0})}),Webcam.on("error",function(n){if(angular.isDefined(d.onError))return d.onError({err:n})})}function a(n){u&&u.play(),n===d.config.shots-1&&i.cancel(s),Webcam.snap(function(i){if(l[n]=i,n<d.config.shots-1&&angular.isDefined(d.onCapturing)){var e=Math.round(100*(n+1)/d.config.shots);d.onCapturing({src:i,progress:e})}if(n===d.config.shots-1&&angular.isDefined(d.onComplete))return d.onComplete({src:l,progress:100})})}function r(){var n=0;s=i(function(){a(n),n++},d.config.delay,d.config.shots)}function f(){Webcam.attach("#ng-webcam-container")}function g(){o()}var u,s,d=this,l=[];d.webcamLoaded=!1,d.webcamLive=!1,d.progress="0%",d.init=e,d.destroy=o,n.$on("ngWebcam_capture",r),n.$on("ngWebcam_on",f),n.$on("ngWebcam_off",g)}var o={restrict:"E",template:n,link:i,bindToController:!0,controller:e,controllerAs:"vm",scope:{config:"=",onComplete:"&",onError:"&",onLoad:"&",onCapturing:"&"}};return e.$inject=["$scope","$interval"],o}angular.module("ng-webcam",[]).directive("ngWebcam",n),n.$inject=[]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5nLXdlYmNhbS5qcyJdLCJuYW1lcyI6WyJuZ1dlYmNhbSIsInRlbXBsYXRlIiwiam9pbiIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImN0cmwiLCJpbml0IiwiJG9uIiwiZGVzdHJveSIsIm5nV2ViY2FtQ29udHJvbGxlciIsIiRzY29wZSIsIiRpbnRlcnZhbCIsInZtIiwiY29uZmlnIiwiYW5ndWxhciIsImlzVW5kZWZpbmVkIiwidmlld2VyV2lkdGgiLCJ2aWV3ZXJIZWlnaHQiLCJvdXRwdXRXaWR0aCIsIm91dHB1dEhlaWdodCIsImRlbGF5Iiwic2hvdHMiLCJjb25maWd1cmUiLCJjb25maWd1cmVMaXN0ZW5lcnMiLCJXZWJjYW0iLCJyZXNldCIsIndlYmNhbUxpdmUiLCJ3ZWJjYW1Mb2FkZWQiLCJpc0RlZmluZWQiLCJzaHV0dGVyVXJsIiwic291bmQiLCJBdWRpbyIsImF1dG9wbGF5IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibWF0Y2giLCJzcmMiLCJzcGxpdCIsInNldCIsIndpZHRoIiwiaGVpZ2h0IiwiZGVzdF93aWR0aCIsImRlc3RfaGVpZ2h0IiwiZmxhc2hGYWxsYmFja1VybCIsInNldFNXRkxvY2F0aW9uIiwiYXR0YWNoIiwib24iLCIkYXBwbHkiLCJvbkxvYWQiLCJlcnIiLCJvbkVycm9yIiwiY2FwdHVyZSIsImluZGV4IiwicGxheSIsImNhbmNlbCIsInRpbWVyIiwic25hcCIsImRhdGFfdXJpIiwiaW1hZ2VzIiwib25DYXB0dXJpbmciLCJwcm9ncmVzcyIsIk1hdGgiLCJyb3VuZCIsIm9uQ29tcGxldGUiLCJvbldlYmNhbUNhcHR1cmUiLCJjb3VudCIsIm9uV2ViY2FtT24iLCJvbldlYmNhbU9mZiIsInRoaXMiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiJGluamVjdCIsIm1vZHVsZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZ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QixFQURBM0MsRUFBQXdELEtBRUFWLElBRUE5QyxHQUFBZSxjQUFBLEVBQ0FmLEVBQUFjLFlBQUEsRUFDQWQsRUFBQWdELFNBQUEsS0FDQWhELEVBQUFOLEtBQUFBLEVBQ0FNLEVBQUFKLFFBQUFBLEVBSUFFLEVBQUFILElBQUEsbUJBQUF5RCxHQUlBdEQsRUFBQUgsSUFBQSxjQUFBMkQsR0FJQXhELEVBQUFILElBQUEsZUFBQTRELEdBaEVBLEdBQUFFLElBQ0FDLFNBQUEsSUFDQXZFLFNBQUFBLEVBQ0FFLEtBQUFBLEVBQ0FzRSxrQkFBQSxFQUNBQyxXQUFBL0QsRUFDQWdFLGFBQUEsS0FDQXZFLE9BQ0FXLE9BQUEsSUFDQWtELFdBQUEsSUFDQWIsUUFBQSxJQUNBRixPQUFBLElBQ0FXLFlBQUEsS0E4S0EsT0F0SkFsRCxHQUFBaUUsU0FBQSxTQUFBLGFBc0pBTCxFQWhNQXZELFFBQUE2RCxPQUFBLGdCQUFBTixVQUFBLFdBQUF2RSxHQUNBQSxFQUFBNEUiLCJmaWxlIjoibmctd2ViY2FtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAvKipcbiAgICpcbiAgICovXG4gIGFuZ3VsYXIubW9kdWxlKCduZy13ZWJjYW0nLCBbXSkuZGlyZWN0aXZlKCduZ1dlYmNhbScsIG5nV2ViY2FtKTtcbiAgbmdXZWJjYW0uJGluamVjdCA9IFtdO1xuICAvKipcbiAgICpcbiAgICovXG4gIGZ1bmN0aW9uIG5nV2ViY2FtKCkge1xuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgdGVtcGxhdGU6IHRlbXBsYXRlLFxuICAgICAgbGluazogbGluayxcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBuZ1dlYmNhbUNvbnRyb2xsZXIsXG4gICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICBzY29wZToge1xuICAgICAgICBjb25maWc6ICc9JyxcbiAgICAgICAgb25Db21wbGV0ZTogJyYnLFxuICAgICAgICBvbkVycm9yOiAnJicsXG4gICAgICAgIG9uTG9hZDogJyYnLFxuICAgICAgICBvbkNhcHR1cmluZzogJyYnXG4gICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRlbXBsYXRlKCkge1xuICAgICAgcmV0dXJuIFsnPGRpdiBjbGFzcz1cIm5nLXdlYmNhbVwiIG5nLXNob3c9XCJ2bS53ZWJjYW1MaXZlXCI+JyxcbiAgICAgICAgJzxkaXYgaWQ9XCJuZy13ZWJjYW0tY29udGFpbmVyXCI+PC9kaXY+J10uam9pbignJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHNjb3BlXG4gICAgICogQHBhcmFtIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0gYXR0cnNcbiAgICAgKiBAcGFyYW0gY3RybFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XG4gICAgICBjdHJsLmluaXQoKTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgICAgY3RybC5kZXN0cm95KCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgLy8gQ29udHJvbGxlciBkZXBlbmRlbmNpZXNcbiAgICBuZ1dlYmNhbUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRpbnRlcnZhbCddO1xuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtICRzY29wZVxuICAgICAqIEBwYXJhbSAkaW50ZXJ2YWxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuZ1dlYmNhbUNvbnRyb2xsZXIoJHNjb3BlLCAkaW50ZXJ2YWwpIHtcbiAgICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgIHZhciBzb3VuZCwgdGltZXI7XG4gICAgICB2YXIgaW1hZ2VzID0gW107XG5cbiAgICAgIHZtLndlYmNhbUxvYWRlZCA9IGZhbHNlO1xuICAgICAgdm0ud2ViY2FtTGl2ZSA9IGZhbHNlO1xuICAgICAgdm0ucHJvZ3Jlc3MgPSAnMCUnO1xuICAgICAgdm0uaW5pdCA9IGluaXQ7XG4gICAgICB2bS5kZXN0cm95ID0gZGVzdHJveTtcbiAgICAgIC8qKlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgJHNjb3BlLiRvbignbmdXZWJjYW1fY2FwdHVyZScsIG9uV2ViY2FtQ2FwdHVyZSk7XG4gICAgICAvKipcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgICRzY29wZS4kb24oJ25nV2ViY2FtX29uJywgb25XZWJjYW1Pbik7XG4gICAgICAvKipcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgICRzY29wZS4kb24oJ25nV2ViY2FtX29mZicsIG9uV2ViY2FtT2ZmKTtcbiAgICAgIC8qKlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgdm0uY29uZmlnID0gdm0uY29uZmlnIHx8IHt9O1xuICAgICAgICBpZihhbmd1bGFyLmlzVW5kZWZpbmVkKHZtLmNvbmZpZy52aWV3ZXJXaWR0aCkpIHZtLmNvbmZpZy52aWV3ZXJXaWR0aCA9ICdhdXRvJztcbiAgICAgICAgaWYoYW5ndWxhci5pc1VuZGVmaW5lZCh2bS5jb25maWcudmlld2VySGVpZ2h0KSkgdm0uY29uZmlnLnZpZXdlckhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgaWYoYW5ndWxhci5pc1VuZGVmaW5lZCh2bS5jb25maWcub3V0cHV0V2lkdGgpKSB2bS5jb25maWcub3V0cHV0V2lkdGggPSAzMjA7XG4gICAgICAgIGlmKGFuZ3VsYXIuaXNVbmRlZmluZWQodm0uY29uZmlnLm91dHB1dEhlaWdodCkpIHZtLmNvbmZpZy5vdXRwdXRIZWlnaHQgPSAyNDA7XG4gICAgICAgIGlmKGFuZ3VsYXIuaXNVbmRlZmluZWQodm0uY29uZmlnLmRlbGF5KSkgdm0uY29uZmlnLmRlbGF5ID0gMDtcbiAgICAgICAgaWYoYW5ndWxhci5pc1VuZGVmaW5lZCh2bS5jb25maWcuc2hvdHMpKSB2bS5jb25maWcuc2hvdHMgPSAxO1xuICAgICAgICBjb25maWd1cmUoKTtcbiAgICAgICAgY29uZmlndXJlTGlzdGVuZXJzKCk7XG4gICAgICB9XG5cbiAgICAgIC8qKlxuICAgICAgICpcbiAgICAgICAqL1xuICAgICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgV2ViY2FtLnJlc2V0KCk7XG4gICAgICAgIHZtLndlYmNhbUxpdmUgPSBmYWxzZTtcbiAgICAgICAgdm0ud2ViY2FtTG9hZGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgaWYoYW5ndWxhci5pc0RlZmluZWQodm0uY29uZmlnLnNodXR0ZXJVcmwpKSB7XG4gICAgICAgICAgc291bmQgPSBuZXcgQXVkaW8oKTtcbiAgICAgICAgICBzb3VuZC5hdXRvcGxheSA9IGZhbHNlO1xuICAgICAgICAgIGlmKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0ZpcmVmb3gvKSkge1xuICAgICAgICAgICAgc291bmQuc3JjID0gdm0uY29uZmlnLnNodXR0ZXJVcmwuc3BsaXQoJy4nKVswXSArICcub2dnJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc291bmQuc3JjID0gdm0uY29uZmlnLnNodXR0ZXJVcmw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFdlYmNhbS5zZXQoe1xuICAgICAgICAgIHdpZHRoOiB2bS5jb25maWcudmlld2VyV2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiB2bS5jb25maWcudmlld2VySGVpZ2h0LFxuICAgICAgICAgIGRlc3Rfd2lkdGg6IHZtLmNvbmZpZy5vdXRwdXRXaWR0aCxcbiAgICAgICAgICBkZXN0X2hlaWdodDogdm0uY29uZmlnLm91dHB1dEhlaWdodFxuICAgICAgICB9KTtcbiAgICAgICAgaWYoYW5ndWxhci5pc0RlZmluZWQodm0uY29uZmlnLmZsYXNoRmFsbGJhY2tVcmwpKSB7XG4gICAgICAgICAgV2ViY2FtLnNldFNXRkxvY2F0aW9uKHZtLmNvbmZpZy5mbGFzaEZhbGxiYWNrVXJsKTtcbiAgICAgICAgfVxuICAgICAgICBXZWJjYW0uYXR0YWNoKCcjbmctd2ViY2FtLWNvbnRhaW5lcicpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBjb25maWd1cmVMaXN0ZW5lcnMoKSB7XG4gICAgICAgIFdlYmNhbS5vbignbG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS53ZWJjYW1Mb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYoYW5ndWxhci5pc0RlZmluZWQodm0ub25Mb2FkKSkge1xuICAgICAgICAgICAgICB2bS5vbkxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFdlYmNhbS5vbignbGl2ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2bS53ZWJjYW1MaXZlID0gdHJ1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIFdlYmNhbS5vbignZXJyb3InLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZihhbmd1bGFyLmlzRGVmaW5lZCh2bS5vbkVycm9yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHZtLm9uRXJyb3Ioe2VycjplcnJ9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIGluZGV4XG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIGNhcHR1cmUoaW5kZXgpIHtcbiAgICAgICAgaWYoc291bmQpIHtcbiAgICAgICAgICBzb3VuZC5wbGF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoaW5kZXggPT09ICh2bS5jb25maWcuc2hvdHMtMSkpIHtcbiAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICBXZWJjYW0uc25hcChmdW5jdGlvbihkYXRhX3VyaSkge1xuICAgICAgICAgIGltYWdlc1tpbmRleF0gPSBkYXRhX3VyaTtcbiAgICAgICAgICBpZihpbmRleCA8ICh2bS5jb25maWcuc2hvdHMtMSkgJiYgYW5ndWxhci5pc0RlZmluZWQodm0ub25DYXB0dXJpbmcpKSB7XG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBNYXRoLnJvdW5kKCgoaW5kZXgrMSkgKiAxMDApIC8gdm0uY29uZmlnLnNob3RzKTtcbiAgICAgICAgICAgIHZtLm9uQ2FwdHVyaW5nKHtcbiAgICAgICAgICAgICAgc3JjOiBkYXRhX3VyaSxcbiAgICAgICAgICAgICAgcHJvZ3Jlc3M6IHByb2dyZXNzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYoaW5kZXggPT09ICh2bS5jb25maWcuc2hvdHMtMSkgJiYgYW5ndWxhci5pc0RlZmluZWQodm0ub25Db21wbGV0ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB2bS5vbkNvbXBsZXRlKHtcbiAgICAgICAgICAgICAgc3JjOiBpbWFnZXMsXG4gICAgICAgICAgICAgIHByb2dyZXNzOiAxMDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqXG4gICAgICAgKi9cbiAgICAgIGZ1bmN0aW9uIG9uV2ViY2FtQ2FwdHVyZSgpIHtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgdGltZXIgPSAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FwdHVyZShjb3VudCk7XG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgfSwgdm0uY29uZmlnLmRlbGF5LCB2bS5jb25maWcuc2hvdHMpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBvbldlYmNhbU9uKCkge1xuICAgICAgICBXZWJjYW0uYXR0YWNoKCcjbmctd2ViY2FtLWNvbnRhaW5lcicpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKlxuICAgICAgICovXG4gICAgICBmdW5jdGlvbiBvbldlYmNhbU9mZigpIHtcbiAgICAgICAgZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuICB9XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
